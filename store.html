<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> ARENA STORE âš¡ - Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ÙˆØ­ÙˆØ´</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;900&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #ffd700; --bg: #0a0a0a; --card: #151515; --main: #0f0; }
        
        body {
            background: var(--bg); color: white; font-family: 'Cairo', sans-serif;
            margin: 0; padding: 20px; text-align: center;
        }

        header {
            background: linear-gradient(180deg, #1a1a1a, var(--bg));
            padding: 30px 10px; border-bottom: 2px solid var(--gold);
            margin-bottom: 30px; border-radius: 0 0 30px 30px;
        }

        .gold-status {
            font-size: 1.5rem; font-weight: 900; color: var(--gold);
            background: rgba(255, 215, 0, 0.1); display: inline-block;
            padding: 10px 25px; border-radius: 50px; border: 1px solid var(--gold);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø´Ø¨ÙƒØ©: 4 Ù…Ù‡Ø§Ø±Ø§Øª ÙÙŠ ÙƒÙ„ Ø³Ø·Ø± */
        .store-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            max-width: 1000px;
            margin: 0 auto;
        }

        .skill-item {
            background: var(--card); border: 2px solid #222;
            padding: 15px 10px; border-radius: 20px;
            transition: 0.3s; position: relative;
            display: flex; flex-direction: column; align-items: center;
        }

        .skill-item:hover { border-color: var(--gold); transform: translateY(-5px); }

        .skill-icon { font-size: 2.5rem; margin-bottom: 10px; }

        .skill-name { font-weight: 900; color: var(--gold); font-size: 1rem; margin-bottom: 5px; }

        .skill-desc {
            font-size: 0.75rem; color: #bbb; line-height: 1.4;
            margin-bottom: 15px; height: 60px; display: flex; align-items: center;
        }

        .skill-price {
            background: var(--gold); color: black; font-weight: 900;
            padding: 8px 15px; border-radius: 12px; cursor: pointer;
            border: none; width: 100%; transition: 0.2s;
        }

        .skill-price:active { transform: scale(0.9); }

        .inventory-badge {
            position: absolute; top: 10px; right: 10px;
            background: var(--main); color: black;
            font-size: 0.7rem; font-weight: 900;
            padding: 2px 8px; border-radius: 8px;
        }

        /* ØªØ­Ø³ÙŠÙ† Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„: Ù„Ùˆ Ø§Ù„Ø´Ø§Ø´Ø© ØµØºÙŠØ±Ø© ÙŠØ¸Ù‡Ø± 2 ÙÙŠ Ø§Ù„Ø³Ø·Ø± */
        @media (max-width: 600px) {
            .store-grid { grid-template-columns: repeat(2, 1fr); }
        }

        .toast {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: white; color: black; padding: 12px 25px;
            border-radius: 50px; font-weight: 900; display: none; z-index: 1000;
        }
    </style>
</head>
<body>

    <header>
        <h1 style="margin:0; font-size: 2rem;">Ù…ØªØ¬Ø± Ø§Ù„Ø£Ø³Ù„Ø­Ø© ÙˆØ§Ù„Ù…Ù‡Ø§Ø±Ø§Øª âš”ï¸</h1>
        <p style="color:#777;">Ø¬Ù‡Ø² Ù†ÙØ³Ùƒ Ù„Ù„Ù…Ù„Ø­Ù…Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</p>
        <div class="gold-status">Ø¬ÙˆÙ„Ø¯: <span id="gold-val">0</span> ğŸ’°</div>
    </header>

    <div class="store-grid">
        <div class="skill-item">
            <div class="inventory-badge" id="inv-spy">0</div>
            <div class="skill-icon">ğŸ‘ï¸</div>
            <div class="skill-name">ÙƒØ´Ù Ø§Ù„Ù…Ø³ØªÙˆØ±</div>
            <div class="skill-desc">Ø®Ø§Øµ Ø¨Ù„Ø¹Ø¨Ø© Ø§Ù„Ø´Ø§ÙŠØ¨: ØªÙ…Ù†Ø­Ùƒ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø±Ø¤ÙŠØ© ÙˆØ±Ù‚Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ù…Ù† ÙŠØ¯ Ø§Ù„Ø®ØµÙ… Ù„Ù…Ø¯Ø© Ø«Ø§Ù†ÙŠØªÙŠÙ† ÙƒØ§Ù…Ù„ØªÙŠÙ†.</div>
            <button class="skill-price" onclick="buy('spy', 150)">150 Ø¬ÙˆÙ„Ø¯</button>
        </div>

        <div class="skill-item">
            <div class="inventory-badge" id="inv-skip">0</div>
            <div class="skill-icon">ğŸƒâ€â™‚ï¸</div>
            <div class="skill-name">Ù‡Ø±ÙˆØ¨ Ø³Ø±ÙŠØ¹</div>
            <div class="skill-desc">Ø®Ø§Øµ Ø¨Ù„Ø¹Ø¨Ø© Ø§Ù„Ù‚Ù†Ø¨Ù„Ø©: ØªÙ…ÙƒÙ†Ùƒ Ù…Ù† ØªØ®Ø·ÙŠ Ø¯ÙˆØ±Ùƒ ØªÙ…Ø§Ù…Ø§Ù‹ Ø¯ÙˆÙ† Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ Ø±Ù‚Ù…ØŒ Ù…Ù…Ø§ ÙŠØ¶Ø¹ Ø§Ù„Ø®ØµÙ… ÙÙŠ Ù…Ø£Ø²Ù‚.</div>
            <button class="skill-price" onclick="buy('skip', 120)">120 Ø¬ÙˆÙ„Ø¯</button>
        </div>

        <div class="skill-item">
            <div class="inventory-badge" id="inv-freeze">0</div>
            <div class="skill-icon">â„ï¸</div>
            <div class="skill-name">ØªØ¬Ù…ÙŠØ¯ Ø§Ù„Ø£Ø¹ØµØ§Ø¨</div>
            <div class="skill-desc">Ø®Ø§Øµ Ø¨Ù„Ø¹Ø¨Ø© Ø§Ù„Ø³Ø±Ø¹Ø© (War): ØªÙ…Ù†Ø¹ Ø§Ù„Ø®ØµÙ… Ù…Ù† Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø´Ø§Ø´ØªÙ‡ Ù„Ù…Ø¯Ø© 3 Ø«ÙˆØ§Ù†ÙØŒ Ù…Ù…Ø§ ÙŠÙ…Ù†Ø­Ùƒ Ø£ÙØ¶Ù„ÙŠØ© Ø³Ø§Ø­Ù‚Ø©.</div>
            <button class="skill-price" onclick="buy('freeze', 180)">180 Ø¬ÙˆÙ„Ø¯</button>
        </div>

        <div class="skill-item">
            <div class="inventory-badge" id="inv-erase">0</div>
            <div class="skill-icon">ğŸ§½</div>
            <div class="skill-name">Ø§Ù„Ø§Ø³ØªÙŠÙƒØ© Ø§Ù„Ø³Ø­Ø±ÙŠØ©</div>
            <div class="skill-desc">Ø®Ø§Øµ Ø¨Ù„Ø¹Ø¨Ø© XO: ØªØªÙŠØ­ Ù„Ùƒ Ù…Ø³Ø­ Ø¢Ø®Ø± Ø¹Ù„Ø§Ù…Ø© (X Ø£Ùˆ O) ÙˆØ¶Ø¹Ù‡Ø§ Ø§Ù„Ø®ØµÙ… ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù„ØªØ¨Ø¯ÙŠÙ„ Ø®Ø·ØªÙ‡.</div>
            <button class="skill-price" onclick="buy('erase', 130)">130 Ø¬ÙˆÙ„Ø¯</button>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙØ§ÙŠØ±Ø¨ÙŠØ³ (Ù†ÙØ³ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©)
        const firebaseConfig = { databaseURL: "https://zeweil-chat-default-rtdb.europe-west1.firebasedatabase.app" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
        const mID = localStorage.getItem('arena_user_id');
        
        if (!mID) {
            alert("Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø­Ø³Ø§Ø¨ Ù„Ø§Ø¹Ø¨. Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø¯Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø£ÙˆÙ„Ø§Ù‹.");
            window.location.href = "index.html"; // Ø§ÙØªØ±Ø¶Ù†Ø§ Ø£Ù† ØµÙØ­Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ø³Ù…Ù‡Ø§ index.html
        }

        const uRef = db.ref(`users/${mID}`);

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø­Ø¸ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ù…ØªØ¬Ø±
        uRef.on('value', snap => {
            const data = snap.val() || { gold: 0, skills: {} };
            document.getElementById('gold-val').innerText = data.gold || 0;
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ù„ÙƒÙ„ Ù…Ù‡Ø§Ø±Ø©
            const skills = data.skills || {};
            document.getElementById('inv-spy').innerText = skills.spy || 0;
            document.getElementById('inv-skip').innerText = skills.skip || 0;
            document.getElementById('inv-freeze').innerText = skills.freeze || 0;
            document.getElementById('inv-erase').innerText = skills.erase || 0;
        });

        // ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø´Ø±Ø§Ø¡
        function buy(skillId, price) {
            uRef.transaction(user => {
                if (!user) return user;
                if ((user.gold || 0) < price) {
                    notify("Ø°Ù‡Ø¨Ùƒ ØºÙŠØ± ÙƒØ§ÙÙ! ğŸ’¸");
                    return; // Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
                }
                
                user.gold -= price;
                if (!user.skills) user.skills = {};
                user.skills[skillId] = (user.skills[skillId] || 0) + 1;
                
                notify("ØªÙ… Ø§Ù„Ø´Ø±Ø§Ø¡ Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰");
                return user;
            });
        }

        function notify(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg;
            t.style.display = 'block';
            setTimeout(() => t.style.display = 'none', 2500);
        }
    </script>
</body>
</html>
